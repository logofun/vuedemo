<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>前端生成验证码</title>
</head>
<body>
<!--画布节点-->
<canvas id="canvas" width="160" height="50"></canvas>

<div><svg viewBox="64 64 896 896" focusable="false"><path d="M485 467.5c-11.6 4.9-20.9 12.2-27.8 22-6.9 9.8-10.4 21.6-10.4 35.5 0 17.8 7.5 31.5 22.4 41.2 14.1 9.1 28.9 11.4 44.4 6.8 17.9-5.2 30-17.9 36.4-38.1 3-9.3 4.5-19.7 4.5-31.3v-50.2c-12.6.4-24.4 1.6-35.5 3.7-11.1 2.1-22.4 5.6-34 10.4zM512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm35.8 262.7c-7.2-10.9-20.1-16.4-38.7-16.4-1.3 0-3 .1-5.3.3-2.2.2-6.6 1.5-12.9 3.7a79.4 79.4 0 00-17.9 9.1c-5.5 3.8-11.5 10-18 18.4-6.4 8.5-11.5 18.4-15.3 29.8l-94-8.4c0-12.4 2.4-24.7 7-36.9 4.7-12.2 11.8-23.9 21.4-35 9.6-11.2 21.1-21 34.5-29.4 13.4-8.5 29.6-15.2 48.4-20.3 18.9-5.1 39.1-7.6 60.9-7.6 21.3 0 40.6 2.6 57.8 7.7 17.2 5.2 31.1 11.5 41.4 19.1a117 117 0 0125.9 25.7c6.9 9.6 11.7 18.5 14.4 26.7 2.7 8.2 4 15.7 4 22.8v182.5c0 6.4 1.4 13 4.3 19.8 2.9 6.8 6.3 12.8 10.2 18 3.9 5.2 7.9 9.9 12 14.3 4.1 4.3 7.6 7.7 10.6 9.9l4.1 3.4-72.5 69.4c-8.5-7.7-16.9-15.4-25.2-23.4-8.3-8-14.5-14-18.5-18.1l-6.1-6.2c-2.4-2.3-5-5.7-8-10.2-8.1 12.2-18.5 22.8-31.1 31.8-12.7 9-26.3 15.6-40.7 19.7-14.5 4.1-29.4 6.5-44.7 7.1-15.3.6-30-1.5-43.9-6.5-13.9-5-26.5-11.7-37.6-20.3-11.1-8.6-19.9-20.2-26.5-35-6.6-14.8-9.9-31.5-9.9-50.4 0-17.4 3-33.3 8.9-47.7 6-14.5 13.6-26.5 23-36.1 9.4-9.6 20.7-18.2 34-25.7s26.4-13.4 39.2-17.7c12.8-4.2 26.6-7.8 41.5-10.7 14.9-2.9 27.6-4.8 38.2-5.7 10.6-.9 21.2-1.6 31.8-2v-39.4c0-13.5-2.3-23.5-6.7-30.1zm180.5 379.6c-2.8 3.3-7.5 7.8-14.1 13.5s-16.8 12.7-30.5 21.1c-13.7 8.4-28.8 16-45 22.9-16.3 6.9-36.3 12.9-60.1 18-23.7 5.1-48.2 7.6-73.3 7.6-25.4 0-50.7-3.2-76.1-9.6-25.4-6.4-47.6-14.3-66.8-23.7-19.1-9.4-37.6-20.2-55.1-32.2-17.6-12.1-31.7-22.9-42.4-32.5-10.6-9.6-19.6-18.7-26.8-27.1-1.7-1.9-2.8-3.6-3.2-5.1-.4-1.5-.3-2.8.3-3.7.6-.9 1.5-1.6 2.6-2.2a7.42 7.42 0 017.4.8c40.9 24.2 72.9 41.3 95.9 51.4 82.9 36.4 168 45.7 255.3 27.9 40.5-8.3 82.1-22.2 124.9-41.8 3.2-1.2 6-1.5 8.3-.9 2.3.6 3.5 2.4 3.5 5.4 0 2.8-1.6 6.3-4.8 10.2zm59.9-29c-1.8 11.1-4.9 21.6-9.1 31.8-7.2 17.1-16.3 30-27.1 38.4-3.6 2.9-6.4 3.8-8.3 2.8-1.9-1-1.9-3.5 0-7.4 4.5-9.3 9.2-21.8 14.2-37.7 5-15.8 5.7-26 2.1-30.5-1.1-1.5-2.7-2.6-5-3.6-2.2-.9-5.1-1.5-8.6-1.9s-6.7-.6-9.4-.8c-2.8-.2-6.5-.2-11.2 0-4.7.2-8 .4-10.1.6a874.4 874.4 0 01-17.1 1.5c-1.3.2-2.7.4-4.1.5-1.5.1-2.7.2-3.5.3l-2.7.3c-1 .1-1.7.2-2.2.2h-3.2l-1-.2-.6-.5-.5-.9c-1.3-3.3 3.7-7.4 15-12.4s22.3-8.1 32.9-9.3c9.8-1.5 21.3-1.5 34.5-.3s21.3 3.7 24.3 7.4c2.3 3.5 2.5 10.7.7 21.7z" /></svg></div>
</body>
<script>
    // 数字，大写字母，小写字母对应的阿斯克码值
    // '0'-'9':48-57
    // 'A'-'Z':65-90
    // 'a'-'z':97-122
    // 获取随机数(随机验证码、canvas随机值都使用到此函数)
    const getRandom = (min, max) => {
        return Math.floor(Math.random() * (max - min + 1)) + min
    }
    // 获取随机颜色
    const getColor = (min, max) => {
        let r = getRandom(min, max);
        let g = getRandom(min, max);
        let b = getRandom(min, max);
        return `rgb(${r},${g},${b}`
    }
    // 获取验证码,在获取的过程中绘制文字、干扰线、干扰圆点
    const getVerificationCode = (selector, width, height) => {
        /**
         * 这里是定义画布
         * **/
            // 获取节点元素
        let canvas = document.querySelector(selector);
        // 获取画布
        let ctx = canvas.getContext('2d');
        // 绘制背景,先获取背景颜色，再设置绘制的起始坐标，以及绘制的宽高
        ctx.fillStyle = getColor(215, 250);
        ctx.fillRect(0, 0, width, height);
        /**
         * 这里是获取验证码，并且绘制到画布
         * **/
            // 定义一个字符串，保存验证码结果
        let verificationCode = '';
        // 循环5次,获取五个验证码字符，并且绘制到画布上
        for (let i = 0; i < 5; i++) {
            // 得到字符的ASCII码值
            let ascii = getRandom(48, 122);
            // 在这个范围的ascii码是无效的，i--，跳过此次循环
            if ((ascii > 57 && ascii < 65) || (ascii > 90 && ascii < 97)) {
                i--;
                continue;
            }
            // ascii码有效
            // 通过ASCII码值得到相应的字符
            const c = String.fromCharCode(ascii);
            // 拼接验证码
            verificationCode += c;
            /**
             * 以上部分已经获取到了所有验证码
             * 以下的代码是设置文字的渲染样式
             */
            // 随机字体大小
            let fontSize = getRandom(height-(height*.4), height-(height*.1));
            // 设置字体大小和字体类型
            ctx.font = fontSize + 'px Simhei';
            // 设置文字的基线，这里设置以顶部为基线
            ctx.textBaseline = 'top';
            // 设置字体的填充颜色
            ctx.fillStyle = getColor(80, 150);
            // 保存样式
            ctx.save();
            // 设置文字的位移
            ctx.translate(30 * i + 20, 10);
            // 随机字体旋转角度
            let deg = getRandom(-30, 30);
            // 设置文字的旋转角度
            ctx.rotate(deg * Math.PI / 180);
            // 绘制文字
            ctx.fillText(c, -10, -10);
            // 恢复，准备绘制下一个文字
            ctx.restore();
        }
        /**
         * 这里是绘制干扰线
         * **/
        // 随机干扰线
        for (let j = 0; j < 5; j++) {
            // 干扰线起始路径
            ctx.beginPath();
            // 起点
            ctx.moveTo(getRandom(0, width), getRandom(0, height));
            // 终点
            ctx.lineTo(getRandom(0, width), getRandom(0, height));
            // 随机干扰线颜色
            ctx.strokeStyle = getColor(180, 230);
            // 关闭路线
            ctx.closePath();
            // 绘制路线
            ctx.stroke();
        }
        /**
         * 这里是绘制小圆点
         * **/
        // 随机干扰圆点
        for (let j = 0; j < 40; j++) {
            ctx.beginPath();
            // 设置圆点的位置，半径，形状
            ctx.arc(getRandom(0, width), getRandom(0, height), 1, 0, 2 * Math.PI);
            ctx.closePath();
            // 设置圆点颜色
            ctx.fillStyle = getColor(150, 200);
            // 绘制圆点
            ctx.fill();
        }
        // 返回验证码（这里只是一个验证码字符串）
        return verificationCode;
    }
    let verificationCode = getVerificationCode('#canvas', 160, 60);
    console.log("生成的验证码是：", verificationCode);
</script>
</html>
